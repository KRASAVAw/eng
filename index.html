<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Дашка</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@500;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FFF9FB;
            --card-bg: #ffffff;
            --primary-color: #F472B6;
            --primary-hover: #EC4899;
            --text-color: #585064;
            --text-muted: #A8A0B5;
            --border-color: #FCE7F3;
            --correct-color: #10B981;
            --incorrect-color: #EF4444;
            --shadow: 0 10px 30px rgba(236, 72, 153, 0.15);
            --font-heading: 'Lora', serif;
            --font-body: 'Nunito', sans-serif;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23FBCFE8' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .container {
            position: relative;
            background: var(--card-bg);
            padding: 35px 40px;
            border-radius: 24px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 550px;
            text-align: center;
            border: 1px solid var(--border-color);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.7s ease-out forwards;
        }
        
        .container::before, .container::after {
            content: '';
            position: absolute;
            width: 100px;
            height: 100px;
            background-repeat: no-repeat;
            background-size: contain;
            opacity: 0.3;
            pointer-events: none;
        }
        .container::before {
            top: -20px;
            left: -20px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M50,10 A20,20 0 0,1 70,30 A20,20 0 0,1 50,50 A20,20 0 0,1 30,30 A20,20 0 0,1 50,10' fill='%23EC4899'/%3E%3Cpath d='M30,70 A20,20 0 0,1 50,90 A20,20 0 0,1 30,70' fill='%23F472B6'/%3E%3Cpath d='M70,70 A20,20 0 0,1 90,50 A20,20 0 0,1 70,70' fill='%23F472B6'/%3E%3Ccircle cx='50' cy='30' r='5' fill='%23fff'/%3E%3C/svg%3E");
        }
        .container::after {
            bottom: -20px;
            right: -20px;
            transform: rotate(180deg);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M50,10 A20,20 0 0,1 70,30 A20,20 0 0,1 50,50 A20,20 0 0,1 30,30 A20,20 0 0,1 50,10' fill='%23EC4899'/%3E%3Cpath d='M30,70 A20,20 0 0,1 50,90 A20,20 0 0,1 30,70' fill='%23F472B6'/%3E%3Cpath d='M70,70 A20,20 0 0,1 90,50 A20,20 0 0,1 70,70' fill='%23F472B6'/%3E%3Ccircle cx='50' cy='30' r='5' fill='%23fff'/%3E%3C/svg%3E");
        }

        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        h1 {
            font-family: var(--font-heading);
            margin-top: 0;
            margin-bottom: 30px;
            font-weight: 700;
            color: var(--primary-hover);
        }

        .view { transition: opacity 0.5s ease, transform 0.5s ease; }
        .hidden-view { position: absolute; opacity: 0; transform: scale(0.95); pointer-events: none; width: calc(100% - 80px); }

        .setting-group { text-align: left; margin-bottom: 20px; }
        .setting-group label {
            margin-bottom: 10px; font-weight: 700; font-size: 14px;
            color: var(--text-muted); display: block;
        }
        .label-with-value { display: flex; justify-content: space-between; align-items: center; }

        select, button, input {
            width: 100%; padding: 14px 16px; border-radius: 12px;
            font-size: 16px; font-family: var(--font-body); box-sizing: border-box;
            background-color: #fff; color: var(--text-color);
            border: 2px solid var(--border-color);
            transition: all 0.25s ease-out;
        }

        select:focus, input:focus {
            outline: none; border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(244, 114, 182, 0.2);
        }
        
        button {
            background: var(--primary-color); color: white; border: none;
            cursor: pointer; font-weight: 700; font-size: 18px;
            transform: translateY(0); margin-top: 20px;
        }
        button:hover {
            background: var(--primary-hover);
            box-shadow: 0 5px 15px rgba(236, 72, 153, 0.3);
            transform: translateY(-3px);
        }
        
        input[type="range"] {
            -webkit-appearance: none; appearance: none; background: transparent; cursor: pointer; padding: 0;
        }
        input[type="range"]::-webkit-slider-runnable-track {
            background: var(--border-color); height: 8px; border-radius: 4px;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; margin-top: -6px;
            background-color: var(--primary-color); height: 20px; width: 20px;
            border-radius: 50%;
        }

        #progress-tracker { color: var(--text-muted); font-weight: 700; margin-bottom: 15px; }

        #word-container {
            padding: 25px; background-color: var(--bg-color); border-radius: 16px; margin-bottom: 20px;
            border: 2px dashed var(--border-color);
        }
        #word-to-translate {
            font-family: var(--font-heading); font-size: 32px; font-weight: 700;
            color: var(--text-color); min-height: 45px;
            transition: opacity 0.3s ease-in-out;
        }
        
        #answer-input { margin-bottom: 15px; }
        #answer-input.correct-glow { border-color: var(--correct-color); box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.2); }
        #answer-input.incorrect-glow { border-color: var(--incorrect-color); box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.2); }
        
        .feedback {
            padding: 12px; border-radius: 12px; margin-top: 20px;
            font-weight: 700; font-size: 16px; min-height: 24px;
            opacity: 0; transform: scale(0.95); transition: all 0.3s ease-in-out;
        }
        .feedback.visible { opacity: 1; transform: scale(1); }
        .feedback.correct { background-color: #F0FDF4; color: var(--correct-color); }
        .feedback.incorrect { background-color: #FEF2F2; color: var(--incorrect-color); }

        .shake-animation { animation: shake 0.5s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }
        
        #score-area {
            margin-top: 35px; padding-top: 25px; border-top: 2px solid var(--border-color);
            display: flex; justify-content: space-around;
        }
        .score-item { display: flex; flex-direction: column; }
        .score-label { color: var(--text-muted); font-size: 14px; font-weight: 700; }
        .score-value { font-weight: 700; font-size: 24px; transition: transform 0.2s ease-out; }
        .score-pop { transform: scale(1.2); }
        #score-correct { color: var(--correct-color); }
        #score-incorrect { color: var(--incorrect-color); }
        #score-total { color: var(--primary-color); }
    </style>
</head>
<body>

    <div class="container" id="container">
        <h1>Дашка</h1>
        
        <div class="settings-view view" id="settings-view">
            <div class="setting-group">
                <label for="level-select">Уровень сложности</label>
                <select id="level-select">
                    <option value="A1">A1 (Beginner)</option>
                    <option value="A2">A2 (Elementary)</option>
                    <option value="B1">B1 (Intermediate)</option>
                    <option value="B2">B2 (Upper-Intermediate)</option>
                    <option value="C1">C1 (Advanced)</option>
                    <option value="C2">C2 (Proficiency)</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="mode-select">Режим игры</label>
                <select id="mode-select">
                    <option value="en-ru">Английский -> Русский</option>
                    <option value="ru-en">Русский -> Английский</option>
                    <option value="mixed">Смешанный</option>
                </select>
            </div>
            <div class="setting-group">
                <div class="label-with-value">
                    <label for="word-count-slider">Количество слов</label>
                    <span id="word-count-display">25</span>
                </div>
                <!-- --- CHANGE --- Slider range is now 10-100 -->
                <input type="range" id="word-count-slider" min="10" max="100" value="25">
            </div>
            <button id="start-button">Начать Тренировку</button>
        </div>

        <div class="game-view view hidden-view" id="game-view">
            <p id="progress-tracker">Слово <span id="current-word-number"></span> из <span id="total-word-number"></span></p>
            <div id="word-container"><p id="word-to-translate"></p></div>
            <input type="text" id="answer-input" placeholder="Введите ваш перевод..." autocomplete="off">
            <button id="action-button">Проверить</button>
            <div id="feedback" class="feedback"></div>
            <div id="score-area">
                <div class="score-item"><span class="score-label">Правильно</span><span id="score-correct" class="score-value">0</span></div>
                <div class="score-item"><span class="score-label">Неправильно</span><span id="score-incorrect" class="score-value">0</span></div>
                <div class="score-item"><span class="score-label">Всего</span><span id="score-total" class="score-value">0</span></div>
            </div>
            <button id="back-button" style="margin-top: 30px; background: none; border: 2px solid var(--border-color); color: var(--text-muted); font-size: 16px;">Закончить</button>
        </div>

        <div class="level-complete-view view hidden-view" id="level-complete-view">
            <h2>🌸 Сессия завершена! 🌸</h2>
            <p>Отличная работа! Вы можете начать заново с другими настройками.</p>
            <button id="restart-button">Начать заново</button>
        </div>
    </div>

    <script>
        // --- CHANGE --- Massively expanded word database to 150 words per level
        const wordDatabase = {
            A1: [
                {en:"apple",ru:"яблоко"},{en:"ask",ru:"спрашивать"},{en:"bad",ru:"плохой"},{en:"ball",ru:"мяч"},{en:"banana",ru:"банан"},
                {en:"bed",ru:"кровать"},{en:"big",ru:"большой"},{en:"bird",ru:"птица"},{en:"black",ru:"черный"},{en:"blue",ru:"синий"},
                {en:"book",ru:"книга"},{en:"box",ru:"коробка"},{en:"boy",ru:"мальчик"},{en:"bread",ru:"хлеб"},{en:"brother",ru:"брат"},
                {en:"bus",ru:"автобус"},{en:"buy",ru:"покупать"},{en:"bye",ru:"пока"},{en:"car",ru:"машина"},{en:"cat",ru:"кошка"},
                {en:"chair",ru:"стул"},{en:"child",ru:"ребенок"},{en:"clean",ru:"чистый"},{en:"close",ru:"закрывать"},{en:"coffee",ru:"кофе"},
                {en:"cold",ru:"холодный"},{en:"color",ru:"цвет"},{en:"come",ru:"приходить"},{en:"cook",ru:"готовить"},{en:"cup",ru:"чашка"},
                {en:"dad",ru:"папа"},{en:"day",ru:"день"},{en:"dirty",ru:"грязный"},{en:"dog",ru:"собака"},{en:"door",ru:"дверь"},
                {en:"drink",ru:"пить"},{en:"eat",ru:"есть"},{en:"egg",ru:"яйцо"},{en:"eight",ru:"восемь"},{en:"eye",ru:"глаз"},
                {en:"face",ru:"лицо"},{en:"family",ru:"семья"},{en:"fast",ru:"быстрый"},{en:"father",ru:"отец"},{en:"find",ru:"находить"},
                {en:"fine",ru:"хорошо"},{en:"finish",ru:"заканчивать"},{en:"fish",ru:"рыба"},{en:"five",ru:"пять"},{en:"floor",ru:"пол"},
                {en:"flower",ru:"цветок"},{en:"food",ru:"еда"},{en:"foot",ru:"нога"},{en:"four",ru:"четыре"},{en:"friend",ru:"друг"},
                {en:"game",ru:"игра"},{en:"get",ru:"получать"},{en:"girl",ru:"девочка"},{en:"give",ru:"давать"},{en:"glass",ru:"стакан"},
                {en:"go",ru:"идти"},{en:"good",ru:"хороший"},{en:"green",ru:"зеленый"},{en:"hand",ru:"рука"},{en:"happy",ru:"счастливый"},
                {en:"have",ru:"иметь"},{en:"he",ru:"он"},{en:"head",ru:"голова"},{en:"hear",ru:"слышать"},{en:"hello",ru:"привет"},
                {en:"help",ru:"помогать"},{en:"here",ru:"здесь"},{en:"horse",ru:"лошадь"},{en:"hot",ru:"горячий"},{en:"house",ru:"дом"},
                {en:"how",ru:"как"},{en:"I",ru:"я"},{en:"juice",ru:"сок"},{en:"jump",ru:"прыгать"},{en:"know",ru:"знать"},
                {en:"leg",ru:"нога"},{en:"like",ru:"нравится"},{en:"listen",ru:"слушать"},{en:"little",ru:"маленький"},{en:"live",ru:"жить"},
                {en:"long",ru:"длинный"},{en:"look",ru:"смотреть"},{en:"love",ru:"любить"},{en:"make",ru:"делать"},{en:"man",ru:"мужчина"},
                {en:"many",ru:"много"},{en:"milk",ru:"молоко"},{en:"money",ru:"деньги"},{en:"mother",ru:"мать"},{en:"mouse",ru:"мышь"},
                {en:"mouth",ru:"рот"},{en:"mum",ru:"мама"},{en:"name",ru:"имя"},{en:"new",ru:"новый"},{en:"night",ru:"ночь"},
                {en:"nine",ru:"девять"},{en:"no",ru:"нет"},{en:"nose",ru:"нос"},{en:"not",ru:"не"},{en:"now",ru:"сейчас"},
                {en:"old",ru:"старый"},{en:"one",ru:"один"},{en:"open",ru:"открывать"},{en:"orange",ru:"оранжевый"},{en:"page",ru:"страница"},
                {en:"park",ru:"парк"},{en:"pen",ru:"ручка"},{en:"pencil",ru:"карандаш"},{en:"phone",ru:"телефон"},{en:"play",ru:"играть"},
                {en:"please",ru:"пожалуйста"},{en:"put",ru:"класть"},{en:"read",ru:"читать"},{en:"red",ru:"красный"},{en:"rice",ru:"рис"},
                {en:"run",ru:"бежать"},{en:"sad",ru:"грустный"},{en:"say",ru:"сказать"},{en:"school",ru:"школа"},{en:"see",ru:"видеть"},
                {en:"seven",ru:"семь"},{en:"she",ru:"она"},{en:"shoe",ru:"туфля"},{en:"shop",ru:"магазин"},{en:"short",ru:"короткий"},
                {en:"sing",ru:"петь"},{en:"sister",ru:"сестра"},{en:"sit",ru:"сидеть"},{en:"six",ru:"шесть"},{en:"sleep",ru:"спать"},
                {en:"slow",ru:"медленный"},{en:"small",ru:"маленький"},{en:"smile",ru:"улыбаться"},{en:"sorry",ru:"извините"},{en:"speak",ru:"говорить"},
                {en:"stand",ru:"стоять"},{en:"start",ru:"начинать"},{en:"stop",ru:"останавливать"},{en:"street",ru:"улица"},{en:"student",ru:"студент"}
            ],
            A2: [
                {en:"above",ru:"над"},{en:"address",ru:"адрес"},{en:"afraid",ru:"испуганный"},{en:"afternoon",ru:"полдень"},{en:"again",ru:"снова"},
                {en:"airport",ru:"аэропорт"},{en:"all",ru:"все"},{en:"also",ru:"также"},{en:"always",ru:"всегда"},{en:"animal",ru:"животное"},
                {en:"answer",ru:"ответ"},{en:"apartment",ru:"квартира"},{en:"arrive",ru:"прибывать"},{en:"aunt",ru:"тетя"},{en:"away",ru:"прочь"},
                {en:"back",ru:"спина"},{en:"bakery",ru:"пекарня"},{en:"balcony",ru:"балкон"},{en:"bathroom",ru:"ванная"},{en:"beautiful",ru:"красивый"},
                {en:"because",ru:"потому что"},{en:"bedroom",ru:"спальня"},{en:"below",ru:"ниже"},{en:"between",ru:"между"},{en:"bicycle",ru:"велосипед"},
                {en:"birthday",ru:"день рождения"},{en:"blouse",ru:"блузка"},{en:"body",ru:"тело"},{en:"bottle",ru:"бутылка"},{en:"breakfast",ru:"завтрак"},
                {en:"bridge",ru:"мост"},{en:"building",ru:"здание"},{en:"business",ru:"бизнес"},{en:"butter",ru:"масло"},{en:"cafe",ru:"кафе"},
                {en:"camera",ru:"камера"},{en:"capital",ru:"столица"},{en:"carrot",ru:"морковь"},{en:"carry",ru:"нести"},{en:"catch",ru:"ловить"},
                {en:"cereal",ru:"хлопья"},{en:"cheese",ru:"сыр"},{en:"chicken",ru:"курица"},{en:"cinema",ru:"кино"},{en:"city",ru:"город"},
                {en:"class",ru:"класс"},{en:"clever",ru:"умный"},{en:"clock",ru:"часы"},{en:"clothes",ru:"одежда"},{en:"cloudy",ru:"облачно"},
                {en:"coat",ru:"пальто"},{en:"computer",ru:"компьютер"},{en:"conversation",ru:"разговор"},{en:"country",ru:"страна"},{en:"cousin",ru:"кузен"},
                {en:"cow",ru:"корова"},{en:"cream",ru:"сливки"},{en:"cross",ru:"пересекать"},{en:"cry",ru:"плакать"},{en:"dance",ru:"танцевать"},
                {en:"dangerous",ru:"опасный"},{en:"dark",ru:"темный"},{en:"date",ru:"дата"},{en:"daughter",ru:"дочь"},{en:"dentist",ru:"стоматолог"},
                {en:"desert",ru:"пустыня"},{en:"desk",ru:"парта"},{en:"dictionary",ru:"словарь"},{en:"different",ru:"разный"},{en:"difficult",ru:"трудный"},
                {en:"dinner",ru:"ужин"},{en:"doctor",ru:"доктор"},{en:"down",ru:"вниз"},{en:"draw",ru:"рисовать"},{en:"dream",ru:"мечта"},
                {en:"dress",ru:"платье"},{en:"drive",ru:"водить"},{en:"driver",ru:"водитель"},{en:"during",ru:"в течение"},{en:"ear",ru:"ухо"},
                {en:"early",ru:"рано"},{en:"east",ru:"восток"},{en:"easy",ru:"легкий"},{en:"email",ru:"электронная почта"},{en:"end",ru:"конец"},
                {en:"engineer",ru:"инженер"},{en:"enough",ru:"достаточно"},{en:"evening",ru:"вечер"},{en:"every",ru:"каждый"},{en:"example",ru:"пример"},
                {en:"excited",ru:"взволнованный"},{en:"exercise",ru:"упражнение"},{en:"expensive",ru:"дорогой"},{en:"fall",ru:"падать"},{en:"famous",ru:"известный"},
                {en:"far",ru:"далеко"},{en:"farm",ru:"ферма"},{en:"farmer",ru:"фермер"},{en:"fat",ru:"толстый"},{en:"feel",ru:"чувствовать"}
            ],
            B1: [
                {en:"ability",ru:"способность"},{en:"abroad",ru:"за границей"},{en:"accept",ru:"принимать"},{en:"accident",ru:"авария"},{en:"achieve",ru:"достигать"},
                {en:"across",ru:"через"},{en:"action",ru:"действие"},{en:"activity",ru:"деятельность"},{en:"actor",ru:"актер"},{en:"actually",ru:"на самом деле"},
                {en:"adult",ru:"взрослый"},{en:"advantage",ru:"преимущество"},{en:"adventure",ru:"приключение"},{en:"advertisement",ru:"реклама"},{en:"advice",ru:"совет"},
                {en:"afford",ru:"позволить себе"},{en:"agree",ru:"соглашаться"},{en:"aim",ru:"цель"},{en:"allow",ru:"позволять"},{en:"almost",ru:"почти"},
                {en:"alone",ru:"один"},{en:"along",ru:"вдоль"},{en:"already",ru:"уже"},{en:"alternative",ru:"альтернатива"},{en:"although",ru:"хотя"},
                {en:"amazing",ru:"удивительный"},{en:"among",ru:"среди"},{en:"amount",ru:"количество"},{en:"ancient",ru:"древний"},{en:"ankle",ru:"лодыжка"},
                {en:"apologize",ru:"извиняться"},{en:"appear",ru:"появляться"},{en:"appearance",ru:"внешность"},{en:"apply",ru:"применять"},{en:"appointment",ru:"встреча"},
                {en:"approach",ru:"подход"},{en:"argue",ru:"спорить"},{en:"argument",ru:"аргумент"},{en:"army",ru:"армия"},{en:"arrange",ru:"организовать"},
                {en:"arrest",ru:"арестовать"},{en:"article",ru:"статья"},{en:"artist",ru:"художник"},{en:"asleep",ru:"спящий"},{en:"assistant",ru:"помощник"},
                {en:"athlete",ru:"спортсмен"},{en:"attack",ru:"атака"},{en:"attend",ru:"посещать"},{en:"attention",ru:"внимание"},{en:"attitude",ru:"отношение"},
                {en:"attract",ru:"привлекать"},{en:"attractive",ru:"привлекательный"},{en:"audience",ru:"аудитория"},{en:"author",ru:"автор"},{en:"available",ru:"доступный"},
                {en:"average",ru:"средний"},{en:"avoid",ru:"избегать"},{en:"award",ru:"награда"},{en:"awful",ru:"ужасный"},{en:"background",ru:"фон"},
                {en:"bake",ru:"печь"},{en:"balance",ru:"баланс"},{en:"band",ru:"группа"},{en:"barbecue",ru:"барбекю"},{en:"baseball",ru:"бейсбол"},
                {en:"based",ru:"основан"},{en:"basketball",ru:"баскетбол"},{en:"bean",ru:"фасоль"},{en:"bear",ru:"медведь"},{en:"beat",ru:"бить"},
                {en:"beef",ru:"говядина"},{en:"before",ru:"до"},{en:"behave",ru:"вести себя"},{en:"behind",ru:"позади"},{en:"believe",ru:"верить"},
                {en:"belong",ru:"принадлежать"},{en:"belt",ru:"ремень"},{en:"benefit",ru:"выгода"},{en:"best",ru:"лучший"},{en:"better",ru:"лучше"},
                {en:"bill",ru:"счет"},{en:"biology",ru:"биология"},{en:"birth",ru:"рождение"},{en:"biscuit",ru:"печенье"},{en:"blanket",ru:"одеяло"},
                {en:"block",ru:"блок"},{en:"blond",ru:"блондин"},{en:"blood",ru:"кровь"},{en:"board",ru:"доска"},{en:"boil",ru:"кипеть"},
                {en:"bone",ru:"кость"},{en:"bookcase",ru:"книжный шкаф"},{en:"boring",ru:"скучный"},{en:"borrow",ru:"одалживать"},{en:"boss",ru:"босс"}
            ],
            B2: [
                {en:"abandon",ru:"покидать"},{en:"absolute",ru:"абсолютный"},{en:"academic",ru:"академический"},{en:"acceptable",ru:"приемлемый"},{en:"accompany",ru:"сопровождать"},
                {en:"account",ru:"счет"},{en:"accurate",ru:"точный"},{en:"accuse",ru:"обвинять"},{en:"acknowledge",ru:"признавать"},{en:"acquire",ru:"приобретать"},
                {en:"actual",ru:"фактический"},{en:"adapt",ru:"адаптироваться"},{en:"additional",ru:"дополнительный"},{en:"adequate",ru:"адекватный"},{en:"adjust",ru:"регулировать"},
                {en:"administration",ru:"администрация"},{en:"admire",ru:"восхищаться"},{en:"admission",ru:"прием"},{en:"adopt",ru:"усыновлять"},{en:"advanced",ru:"продвинутый"},
                {en:"affair",ru:"дело"},{en:"afterwards",ru:"впоследствии"},{en:"agency",ru:"агентство"},{en:"agenda",ru:"повестка дня"},{en:"aggressive",ru:"агрессивный"},
                {en:"aid",ru:"помощь"},{en:"aircraft",ru:"самолет"},{en:"alarm",ru:"тревога"},{en:"alter",ru:"изменять"},{en:"amount",ru:"количество"},
                {en:"anger",ru:"гнев"},{en:"angle",ru:"угол"},{en:"anniversary",ru:"годовщина"},{en:"annual",ru:"ежегодный"},{en:"anxious",ru:"озабоченный"},
                {en:"apparent",ru:"очевидный"},{en:"appeal",ru:"обращение"},{en:"appreciate",ru:"ценить"},{en:"appropriate",ru:"соответствующий"},{en:"approval",ru:"одобрение"},
                {en:"approve",ru:"одобрять"},{en:"arise",ru:"возникать"},{en:"armed",ru:"вооруженный"},{en:"arms",ru:"оружие"},{en:"artificial",ru:"искусственный"},
                {en:"artistic",ru:"художественный"},{en:"ashamed",ru:"пристыженный"},{en:"aspect",ru:"аспект"},{en:"assess",ru:"оценивать"},{en:"assessment",ru:"оценка"},
                {en:"associate",ru:"ассоциировать"},{en:"association",ru:"ассоциация"},{en:"assume",ru:"предполагать"},{en:"assumption",ru:"предположение"},{en:"assure",ru:"уверять"},
                {en:"atmosphere",ru:"атмосфера"},{en:"attach",ru:"прикреплять"},{en:"attempt",ru:"попытка"},{en:"awareness",ru:"осведомленность"},{en:"backup",ru:"резервная копия"},
                {en:"bake",ru:"печь"},{en:"ban",ru:"запрещать"},{en:"barrier",ru:"барьер"},{en:"basically",ru:"в основном"},{en:"battle",ru:"битва"},
                {en:"beauty",ru:"красота"},{en:"belief",ru:"вера"},{en:"bend",ru:"гнуть"},{en:"besides",ru:"кроме того"},{en:"bias",ru:"предвзятость"},
                {en:"bid",ru:"предложение"},{en:"bind",ru:"связывать"},{en:"biological",ru:"биологический"},{en:"blame",ru:"винить"},{en:"blind",ru:"слепой"},
                {en:"bond",ru:"связь"},{en:"border",ru:"граница"},{en:"bother",ru:"беспокоить"},{en:"bound",ru:"обязанный"},{en:"branch",ru:"ветка"},
                {en:"brand",ru:"бренд"},{en:"breathe",ru:"дышать"},{en:"brick",ru:"кирпич"},{en:"brief",ru:"краткий"},{en:"bright",ru:"яркий"},
                {en:"brilliant",ru:"блестящий"},{en:"broad",ru:"широкий"},{en:"broadcast",ru:"трансляция"},{en:"budget",ru:"бюджет"},{en:"burden",ru:"бремя"}
            ],
            C1: [
                {en:"abolish",ru:"упразднять"},{en:"absorption",ru:"поглощение"},{en:"absurd",ru:"абсурдный"},{en:"abundance",ru:"изобилие"},{en:"accomplice",ru:"сообщник"},
                {en:"accountability",ru:"подотчетность"},{en:"accumulate",ru:"накапливать"},{en:"accusation",ru:"обвинение"},{en:"acquaintance",ru:"знакомый"},{en:"acquisition",ru:"приобретение"},
                {en:"acute",ru:"острый"},{en:"adherence",ru:"приверженность"},{en:"adjacent",ru:"смежный"},{en:"administer",ru:"управлять"},{en:"adolescent",ru:"подросток"},
                {en:"adverse",ru:"неблагоприятный"},{en:"advocate",ru:"защитник"},{en:"aesthetic",ru:"эстетический"},{en:"affection",ru:"привязанность"},{en:"aftermath",ru:"последствия"},
                {en:"aggression",ru:"агрессия"},{en:"alien",ru:"инопланетянин"},{en:"alignment",ru:"выравнивание"},{en:"allege",ru:"утверждать"},{en:"allocate",ru:"выделять"},
                {en:"allowance",ru:"пособие"},{en:"ally",ru:"союзник"},{en:"amateur",ru:"любитель"},{en:"ambassador",ru:"посол"},{en:"amend",ru:"вносить поправки"},
                {en:"amid",ru:"среди"},{en:"analogy",ru:"аналогия"},{en:"ancestor",ru:"предок"},{en:"anchor",ru:"якорь"},{en:"anonymous",ru:"анонимный"},
                {en:"apparatus",ru:"аппарат"},{en:"applicable",ru:"применимый"},{en:"appoint",ru:"назначать"},{en:"arbitrary",ru:"произвольный"},{en:"architect",ru:"архитектор"},
                {en:"archive",ru:"архив"},{en:"arena",ru:"арена"},{en:"array",ru:"массив"},{en:"articulate",ru:"четко выражать"},{en:"ash",ru:"пепел"},
                {en:"aspiration",ru:"стремление"},{en:"assassination",ru:"убийство"},{en:"assault",ru:"нападение"},{en:"assemble",ru:"собирать"},{en:"assert",ru:"утверждать"},
                {en:"asset",ru:"актив"},{en:"assign",ru:"назначать"},{en:"assumption",ru:"предположение"},{en:"asylum",ru:"убежище"},{en:"atrocity",ru:"зверство"},
                {en:"attain",ru:"достигать"},{en:"attribute",ru:"атрибут"},{en:"auction",ru:"аукцион"},{en:"audit",ru:"аудит"},{en:"authentic",ru:"подлинный"},
                {en:"authorize",ru:"разрешать"},{en:"autonomy",ru:"автономия"},{en:"availability",ru:"доступность"},{en:"averse",ru:"несклонный"},{en:"aviation",ru:"авиация"},
                {en:"axis",ru:"ось"},{en:"ballot",ru:"бюллетень"},{en:"banner",ru:"знамя"},{en:"barely",ru:"едва"},{en:"barrel",ru:"бочка"},
                {en:"basin",ru:"бассейн"},{en:"bat",ru:"летучая мышь"},{en:"battlefield",ru:"поле битвы"},{en:"bay",ru:"залив"},{en:"beam",ru:"луч"},
                {en:"beast",ru:"зверь"},{en:"behalf",ru:"от имени"},{en:"beloved",ru:"возлюбленный"},{en:"benchmark",ru:"эталон"},{en:"beneath",ru:"под"},
                {en:"beneficiary",ru:"бенефициар"},{en:"beverage",ru:"напиток"},{en:"bewilder",ru:"сбивать с толку"},{en:"bias",ru:"предвзятость"},{en:"biography",ru:"биография"}
            ],
            C2: [
                {en:"abate",ru:"уменьшать"},{en:"aberration",ru:"отклонение"},{en:"abhor",ru:"ненавидеть"},{en:"abject",ru:"жалкий"},{en:"abjure",ru:"отрекаться"},
                {en:"abnegation",ru:"самоотречение"},{en:"abrogate",ru:"отменять"},{en:"abscond",ru:"скрываться"},{en:"abstruse",ru:"заумный"},{en:"accede",ru:"соглашаться"},
                {en:"accolade",ru:"похвала"},{en:"acerbic",ru:"едкий"},{en:"acquiesce",ru:"уступать"},{en:"acrimonious",ru:"язвительный"},{en:"acumen",ru:"проницательность"},
                {en:"adamant",ru:"непреклонный"},{en:"admonish",ru:"упрекать"},{en:"adulation",ru:"лесть"},{en:"adumbrate",ru:"намекать"},{en:"aegis",ru:"эгида"},
                {en:"affable",ru:"приветливый"},{en:"aggrandize",ru:"преувеличивать"},{en:"alacrity",ru:"рвение"},{en:"allay",ru:"успокаивать"},{en:"ambivalent",ru:"двойственный"},
                {en:"ameliorate",ru:"улучшать"},{en:"anachronistic",ru:"анахроничный"},{en:"anathema",ru:"анафема"},{en:"ancillary",ru:"вспомогательный"},{en:"anodyne",ru:"болеутоляющее"},
                {en:"antipathy",ru:"антипатия"},{en:"antithetical",ru:"противоположный"},{en:"aplomb",ru:"апломб"},{en:"apocryphal",ru:"апокрифический"},{en:"apogee",ru:"апогей"},
                {en:"apostate",ru:"отступник"},{en:"apotheosis",ru:"апофеоз"},{en:"approbation",ru:"одобрение"},{en:"arcane",ru:"тайный"},{en:"archetypal",ru:"архетипический"},
                {en:"arduous",ru:"трудный"},{en:"arrant",ru:"отъявленный"},{en:"ascetic",ru:"аскетичный"},{en:"asperity",ru:"резкость"},{en:"assiduous",ru:"усердный"},
                {en:"assuage",ru:"успокаивать"},{en:"astringent",ru:"вяжущий"},{en:"atavism",ru:"атавизм"},{en:"attenuate",ru:"ослаблять"},{en:"audacious",ru:"дерзкий"},
                {en:"auspicious",ru:"благоприятный"},{en:"austere",ru:"суровый"},{en:"avarice",ru:"жадность"},{en:"aver",ru:"утверждать"},{en:"axiomatic",ru:"аксиоматический"},
                {en:"bacchanalian",ru:"вакхический"},{en:"baleful",ru:"пагубный"},{en:"banal",ru:"банальный"},{en:"bastion",ru:"бастион"},{en:"bellicose",ru:"воинственный"},
                {en:"benign",ru:"доброкачественный"},{en:"bevy",ru:"стая"},{en:"bilk",ru:"обманывать"},{en:"blandishment",ru:"лесть"},{en:"blight",ru:"упадок"},
                {en:"blithe",ru:"беззаботный"},{en:"bombastic",ru:"напыщенный"},{en:"boorish",ru:"невежливый"},{en:"brazen",ru:"наглый"},{en:"broach",ru:"затрагивать"},
                {en:"bucolic",ru:"пасторальный"},{en:"burgeon",ru:"расцветать"},{en:"burnish",ru:"полировать"},{en:"buttress",ru:"поддерживать"},{en:"byzantine",ru:"византийский"},
                {en:"cabal",ru:"клик"},{en:"cachinnate",ru:"хохотать"},{en:"cacophony",ru:"какофония"},{en:"cajole",ru:"задабривать"},{en:"callous",ru:"черствый"},
                {en:"calumny",ru:"клевета"},{en:"canard",ru:"утка"},{en:"capitulate",ru:"капитулировать"},{en:"capricious",ru:"капризный"},{en:"captious",ru:"придирчивый"}
            ]
        };

        const settingsView = document.getElementById('settings-view');
        const gameView = document.getElementById('game-view');
        const levelCompleteView = document.getElementById('level-complete-view');
        const levelSelect = document.getElementById('level-select');
        const modeSelect = document.getElementById('mode-select');
        const wordCountSlider = document.getElementById('word-count-slider');
        const wordCountDisplay = document.getElementById('word-count-display');
        const startButton = document.getElementById('start-button');
        const backButton = document.getElementById('back-button');
        const restartButton = document.getElementById('restart-button');
        const currentWordNumberElem = document.getElementById('current-word-number');
        const totalWordNumberElem = document.getElementById('total-word-number');
        const wordToTranslateElem = document.getElementById('word-to-translate');
        const answerInput = document.getElementById('answer-input');
        const actionButton = document.getElementById('action-button');
        const feedbackElem = document.getElementById('feedback');
        const scoreCorrectElem = document.getElementById('score-correct');
        const scoreIncorrectElem = document.getElementById('score-incorrect');
        const scoreTotalElem = document.getElementById('score-total');

        let currentWord = null;
        let correctCount = 0;
        let incorrectCount = 0;
        let shuffledWords = [];
        let totalWordsInSession = 0;
        let gameState = 'answering'; // 'answering' or 'reviewing'

        function switchView(viewToShow) {
            [settingsView, gameView, levelCompleteView].forEach(view => {
                view.classList.toggle('hidden-view', view.id !== viewToShow.id);
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startGame() {
            const level = levelSelect.value;
            const fullWordList = [...wordDatabase[level]];
            const desiredCount = parseInt(wordCountSlider.value, 10);
            
            // The number of words will be the smaller of the two: desired count or available words.
            const sessionWordCount = Math.min(desiredCount, fullWordList.length);
            
            shuffledWords = shuffleArray(fullWordList).slice(0, sessionWordCount);
            totalWordsInSession = shuffledWords.length;
            totalWordNumberElem.textContent = totalWordsInSession;
            
            correctCount = 0; incorrectCount = 0;
            updateScore();
            switchView(gameView);
            generateNewWord();
        }

        function generateNewWord() {
            if (shuffledWords.length === 0) {
                switchView(levelCompleteView);
                return;
            }
            
            resetForNextRound();
            
            const wordPair = shuffledWords.pop();
            currentWordNumberElem.textContent = totalWordsInSession - shuffledWords.length;
            const mode = modeSelect.value === 'mixed' ? (Math.random() < 0.5 ? 'en-ru' : 'ru-en') : modeSelect.value;

            if (mode === 'en-ru') {
                wordToTranslateElem.textContent = wordPair.en;
                currentWord = { source: wordPair.en, answer: wordPair.ru };
            } else {
                wordToTranslateElem.textContent = wordPair.ru;
                currentWord = { source: wordPair.ru, answer: wordPair.en };
            }
            
            requestAnimationFrame(() => {
                wordToTranslateElem.style.opacity = '1';
            });
        }

        function checkAnswer() {
            const userAnswer = answerInput.value.trim().toLowerCase();
            if (!userAnswer) return;

            const correctAnswer = currentWord.answer.toLowerCase();
            
            if (userAnswer === correctAnswer) {
                correctCount++;
                feedbackElem.innerHTML = `✅ Правильно! Перевод: <strong>${currentWord.answer}</strong>`;
                feedbackElem.className = 'feedback correct visible';
                answerInput.classList.add('correct-glow');
                animateScore(scoreCorrectElem);
            } else {
                incorrectCount++;
                feedbackElem.innerHTML = `❌ Неверно. Правильный ответ: <strong>${currentWord.answer}</strong>`;
                feedbackElem.className = 'feedback incorrect visible';
                answerInput.classList.add('incorrect-glow', 'shake-animation');
                setTimeout(() => answerInput.classList.remove('shake-animation'), 500);
                animateScore(scoreIncorrectElem);
            }
            
            animateScore(scoreTotalElem);
            updateScore();
            
            gameState = 'reviewing';
            answerInput.disabled = true;
            actionButton.textContent = 'Следующее слово';
            actionButton.focus();
        }
        
        function updateScore() {
            scoreCorrectElem.textContent = correctCount;
            scoreIncorrectElem.textContent = incorrectCount;
            scoreTotalElem.textContent = correctCount + incorrectCount;
        }

        function animateScore(element) {
            element.classList.add('score-pop');
            setTimeout(() => element.classList.remove('score-pop'), 200);
        }

        function resetForNextRound() {
            gameState = 'answering';
            answerInput.value = '';
            answerInput.disabled = false;
            answerInput.className = '';
            feedbackElem.classList.remove('visible', 'correct', 'incorrect');
            actionButton.textContent = 'Проверить';
            answerInput.focus();
        }
        
        function returnToMenu() {
            switchView(settingsView);
        }
        
        function updateSliderMax() {
            const selectedLevel = levelSelect.value;
            const maxWordsForLevel = wordDatabase[selectedLevel].length;
            // The slider's max value is capped at 100, or the number of available words if less.
            wordCountSlider.max = Math.min(maxWordsForLevel, 100);
            
            // If the current slider value is greater than the new max, adjust it.
            if (parseInt(wordCountSlider.value) > parseInt(wordCountSlider.max)) {
                wordCountSlider.value = wordCountSlider.max;
            }
            wordCountDisplay.textContent = wordCountSlider.value;
        }

        function handleActionClick() {
            if (gameState === 'answering') {
                checkAnswer();
            } else { 
                wordToTranslateElem.style.opacity = '0';
                setTimeout(generateNewWord, 300);
            }
        }
        
        document.addEventListener('keyup', function(event) {
            if (event.key !== 'Enter') return;
            if (!gameView.classList.contains('hidden-view')) {
                if (gameState === 'answering' && document.activeElement === answerInput) {
                    handleActionClick();
                } else if (gameState === 'reviewing') {
                    handleActionClick();
                }
            }
        });

        startButton.addEventListener('click', startGame);
        backButton.addEventListener('click', returnToMenu);
        restartButton.addEventListener('click', returnToMenu);
        actionButton.addEventListener('click', handleActionClick);
        wordCountSlider.addEventListener('input', () => { wordCountDisplay.textContent = wordCountSlider.value; });
        levelSelect.addEventListener('change', updateSliderMax);
        document.addEventListener('DOMContentLoaded', updateSliderMax);
    </script>
</body>
</html>